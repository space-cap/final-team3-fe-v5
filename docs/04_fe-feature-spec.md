# 프론트엔드 기능 명세

본 문서는 Q&A 케어 저널의 핵심 사용자 여정과 프론트엔드 구현 요구사항을 상세히 기술한다. 모든 사용자 흐름은 "매일 하나의 질문을 받고 답변을 작성·저장·회고한다"는 목표를 지원해야 한다.

## 1. 사용자 페르소나 & 시나리오
- **주 사용자**: 일일 저널링으로 자기 성찰을 원하는 20~40대 직장인
- **보조 사용자**: 질문 카탈로그를 운영하는 에디터(웹 관리 툴 기준)
- **대표 시나리오**
  1. 사용자는 앱에 접속해 오늘의 질문을 확인하고 답변을 작성한다.
  2. 작성한 답변은 저장 후 즉시 확인 가능하며, 이후 히스토리에서 다시 열람할 수 있다.
  3. 사용자는 질문 라이브러리에서 다른 질문을 미리 확인하거나 카테고리별로 탐색한다.

## 2. 화면 정의
| 화면 | 설명 | 주요 구성 요소 | 선행 조건 |
| --- | --- | --- | --- |
| 온보딩 | 첫 접속 시 사용자 목표/알림 설정 | Stepper, 선호 카테고리 선택, 요약 카드 | 로그인 또는 익명 세션 확보 |
| 오늘의 질문 | 당일 질문 노출 및 답변 작성 | 질문 카드, 답변 폼, 자동 저장 인디케이터, 제출 버튼 | 오늘 질문 페치 완료 |
| 답변 히스토리 | 과거 답변 목록/상세 | 필터(카테고리/날짜), 리스트, 상세 모달, 편집 버튼 | 최소 한 번 이상 답변 작성 |
| 질문 라이브러리 | 365+ 질문 탐색 | 카테고리 탭, 검색, 즐겨찾기 버튼, 질문 상세 Drawer | 에디터 권한일 경우 CRUD 버튼 |

## 3. 기능 상세
### 3.1 오늘의 질문 표시
- 매일 0시 UTC 기준으로 새로운 질문을 할당한다.
- 질문 데이터 구조: `{ id, title, body, category, dayIndex }`
- UI 상태
  - 로딩: 스켈레톤 카드 3개 표시
  - 성공: 질문 제목/본문/카테고리 배지, 이전 답변 보기 CTA
  - 실패: 재시도 버튼 + 오류 안내(toast)

### 3.2 답변 작성 및 저장
- 답변 입력은 최소 50자, 최대 2000자 제한
- 입력 중 3초 이상 정지 시 로컬 초안(auto-save) 저장
- 제출 동작
  1. Form 유효성 검사 → Supabase `answers` 테이블에 `insert`
  2. 성공 시 확인 토스트 + 히스토리 캐시 무효화
  3. 실패 시 오류 메시지 + 재시도 버튼, 초안은 유지
- 보조 기능: "다음에 이어서 쓰기" 버튼, 취소 시 confirm 모달

### 3.3 이전 답변 조회
- 히스토리 리스트는 최근 작성 순, 무한 스크롤
- 각 아이템: 질문 요약, 작성일, 감정 태그(옵션)
- 상세 보기: 사이드 모달, 내용 편집(on/off), 수정 시 히스토리 항목 자동 갱신
- 필터: 날짜 범위, 카테고리, 키워드 검색

### 3.4 질문 라이브러리 관리
- 사용자는 모든 질문을 카테고리별로 열람 가능, 에디터는 CRUD 가능
- 카테고리: 최소 5개 이상, 각 질문은 단일 카테고리에 속한다.
- 즐겨찾기: 사용자는 즐겨찾기한 질문을 히스토리에서 빠르게 접근
- 검색: 제목/본문 전체 텍스트 검색, 300ms debounce

## 4. 데이터 계약(초안)
| 리소스 | 필드 | 설명 |
| --- | --- | --- |
| `Question` | `id: string` | Supabase primary key |
|  | `title: string` | 질문 제목 |
|  | `body: string` | 질문 본문(최대 500자) |
|  | `category: 'growth' · 'relationship' · 'habit' · 'emotion' · 'etc'` | 단일 카테고리 |
|  | `day_index: number` | 1~365 매핑 |
| `Answer` | `id: string` | 작성 답변 ID |
|  | `question_id: string` | 참조 키 |
|  | `user_id: string` | Supabase Auth user id |
|  | `content: string` | 답변 텍스트 |
|  | `created_at: string` | ISO timestamp |
|  | `updated_at: string` | 편집 시 갱신 |

## 5. 인터랙션 & UX 고려사항
- 키보드 접근성: 탭 순서 정의, 주요 액션은 `Enter`/`Esc`로 가능
- 모바일 대응: 1단 레이아웃, 고정 CTA 버튼, 입력 시 헤더 축소
- 멘탈 모델: 오늘 질문은 단일 카드, 히스토리는 타임라인 형태 유지
- 알림: 답변 미작성 상태에서 이탈 시 브라우저 알림/이메일 리마인더(선택)

## 6. 생애주기 & 에지 케이스
- 질문 미배정 시: 플레이스홀더 메시지 + 라이브러리 탐색 CTA
- 중복 제출 방지: 제출 중 버튼 로딩 처리, 낙관적 갱신 금지
- 세션 만료: 저장 시 토큰 만료 에러 → 로그인 모달 호출
- 오프라인: 네트워크 끊김 감지 시 배너 노출, 초안 저장 안내

## 7. 측정 & 로깅 포인트
- `question_viewed` (일자, question_id)
- `answer_drafted` (question_id, 초안 길이, 저장 시각)
- `answer_submitted` (question_id, content_length)
- `answer_edited` (answer_id, edit_count)
- `library_search` (query, 카테고리)

## 8. 향후 확장 아이디어
- 답변 감정 분석 결과(긍정/중립/부정) 뱃지 표시
- 답변 공유 기능(익명 링크, PDF 추출 등)
- 질문 추천 엔진(사용자 선호 태그 기반)

문서 변경 시 `03_fe-architecture.md`와 동기화하여 폴더 구조/상태 관리 전략이 일치하도록 유지한다.
